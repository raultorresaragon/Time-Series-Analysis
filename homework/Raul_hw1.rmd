---
title: "Raul_hw1"
author: "Raul Torres Aragon"
date: "4/16/2022"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Problem 1: Identifying unknown stationary time series processes  

In the file mysterytsUW.csv, you will find 18 columns of time series data. Each column is an independent time series generated by your instructor to have a particular structure. That structure might include a deterministic time trend, seasonal effects, AR(p) processes, and/or MA(q) process. All of these time series can be assumed to be covariance stationary.  

For each series, your task is to make your best guess of the data generating process (DGP) which produced the data. Thus, for each time series a. to r., you should indicate whether you suspect the time series DGP includes any of the following four components: deterministic trend, seasonality, autoregression, or moving average.  

The first 12 time series – a. to l. – contain at most one of the four components above. The remaining six time series – m. to r. – may contain more than one component.

```{r p1}
d1 <- read.csv("512_hw1_data1.csv")
ts1 <- ts(d1)
```

#### (a)  
Because ACF shows an initial negative spike at lag(2) and no gradual return to its mean, 
I think this TS is MA(1) with $\rho_1 \approx -0.4$  

#### (b)  
Given that the ACF shows a significant spike at periods 12, 24, and 36, I think there's
seasonality at play here. A plot of periods 1-12, 13-24, and 25-36 confirmed spikes at "month" 12.  

#### (c)  
This TS is upward trending. After regressing TS on time, obtaining fitted values, and subtracting
from the TS, I confirmed the upward trend was gone.  

#### (d)  
The ACF shows a positive and significant spike at lag(1), then a return to zero. 
The PACF shows a positive spike at lag(1) (as expected), 
but also a negative spike at lag(2). This explains the rapid return to zero. Hence, I think this
is an AR(2) with $\phi_1 \approx 0.5$ and $\phi_2 \approx -0.4$.  

#### (e)  
ACF shows a large positive spike at lag(1) and then a gradual return to zero. 
PACF shows only one positive spike at lag(1). I think this is AR(1) with $\phi_1 \approx 0.7$  

#### (f)  
ACF and PACF show spikes at periods 1, 3, 12, 15, 19, 24. Some are probably spurious, but 
there seems to be weekly seasonality. Splitting the TS into periods of 1 to 7 shows a 
negative "Wednesday" effect.  

#### (g)  
ACF shows gradual return to zero after a large significant spike at lag(1). PACF confirms the large 
spike at lag(1), but it also shows no other significant spikes. This is an AR(1) with $\phi_1 \approx 0.7$  

#### (h)  
ACF shows initial significant spike at lag(1) but an immediate return to zero. PACF shows signiciant 
spikes in opposite direction (i.e. cancelling each other) at lag(1) and lag(2). This is an AR(2) with
$\phi_1 \approx 0.5$ and $\phi_2 \approx -0.3$.  

#### (i)  
Not much going on here. No strong evidence for AR or MA processes. Also no deterministic trend. 
(I subtracted fitted values and got the same TS). No spikes to suggest seasonality either. 
I'd say this is just a random TS with no trend, autoregression, or seasonality.  

#### (j)  
The time plot shows a recurring pattern. ACF and PACF plots suggest spikes 12. Splitting the TS into 
periods of 12 shows additive seasonality, but ACF and PACF did not pick up on strong correlations.  
```{r}
l = "j"
k = which(letters == l)
# seasonality?
par(mfrow = c(3,1))
plot(ts(ts1[ 1:12,k]), main = "periods 1-12")
plot(ts(ts1[13:24,k]), main = "periods 13-24")
plot(ts(ts1[25:36,k]), main = "periods 25-36")
```  

#### (k)  
After seeing the negative trend on the time plot, I regressed TS on time. 
I then subtracted the fitted values from the TS and plotted it. The trend was gone. 
Hence, this is a TS with deterministic negative trend of $\beta_1 \approx -0.06$.  

#### (l)  
This TS has a strong AR(1) with $\phi_1 \approx 0.9$ which is evidenced by the long positive spike 
in the ACF and PACF. Furthermore, the ACF shows a geometric decline back to zero, and the PACF show 
no other significant spike--which rule out AR(2) or MA process.  

#### (m)  
This TS exhibits positive seasonality on periods 12, and negative seasonality in periods 3 and 4, for cycles of 12 periods. This means periods 12, 24, 36 are positively correlated, but periods 3 and 15, and 4 and 16 are negatively correlated. Though the negative patter might be spurious, as it's not significant in the PACF (but it is in the ACF). This also exhibits seasonality as the patter repeates in cycles of 12 periods.  

```{r}
ts1 <- ts(d1, names = letters[1:ncol(d1)])
s1 <-  1:20
s2 <-  1:100
s3<-  1:1000
myplots <- function(ts, l, s = NA){
  l = l
  k = which(letters == l)
  par(mfrow = c(3,1))
  plot(ts(ts[s,k]), main = paste(l, " ~ time"))
  acf (ts(ts[s,k]), lag.max = 24, main = "ACF")
  pacf(ts(ts[s,k]), lag.max = 24, main = "PACF")
}
```
```{r}
l <- "m"
myplots(ts1,l,s2)
```  
```{r}
par(mfrow = c(3,1))
plot(ts(ts1[ 1:12, k]), main = "first 12")
plot(ts(ts1[13:24, k]), main = "second 12")
plot(ts(ts1[25:36, k]), main = "third 12")
```


#### (n)  
On a first look, this looks like an AR(1) with $\phi_1 > 1$ but after seeing the PACF, this looks more like an AR(6) TS with $\phi_1 \approx 0.9$ and $\phi_6 \approx 0.2$, so this is nonstationary, even explosive. (There was also a deterministic trend downward ($\beta_1 \approx .004$) that I removed. Although this trending period could be misleading as this is non-stationary and hence there could be spurious trends. 

#### (o)  
Based on PACF, this seems to be an $ARMA(1,0)_{12}$ with $\phi_1 \approx 0.5$, $\phi_3 = \phi_4 \approx -0.4$, $\phi_5 \approx 0.3$, $\phi_8 \approx = -0.6$ and $\phi_12  \approx 0.3$. and gping in cycles of 12 periods. IT also had somewhat of an upper trend, so I detrended it to be safe ($\beta_1 \approx -.02$).  

#### (p)  
This TS is downward trending $\beta \approx -0.25$ and it's AR(12) with $\phi_1 \approx 0.6$, $\phi_3 \approx -0.4$, $\phi_10 \approx 0.4$ and $\phi_12 \approx -0.6$. This explains its oscillating above and below its mean rapidly.  

#### (q)  
This TS looks like AR(13) with $\phi_1 \approx 0.3$, $\phi_2 \approx 0.25$, and $\phi_13 \approx -0.3$. No trend and no seasonality based on my reading of PACF and time plot.  

#### (r)  
This TS has upward deterministic trend ($\beta_1 \approx 0.03$). After detrending and plotting ACF and PACF, it seems this series is an MA(1) $\rho \approx 0.45$ because the ACF drops immediately after the first shock. In other words, the shock disappears after the first period--no gradual decline after. 



# Problem 2: Identify unknown, possibly nonstationary time series processes  

In this problem, we focus on the problem of identifying nonstationarity. 
In the file mysterytsUW2.csv, you will find five additional time series, s. to w. 
Once again, each column is an independent time series generated to have a particular structure. 
All of these series follow some AR(p) process. 
No moving average processes, deterministic trends, or seasonal variation are present in these time series. 
However, these five time series are not guaranteed to be covariance stationary. 
For each time series:  

(i.) Subset the first 20 observations. Plot them against time and plot the ACFs and PACFs. (There is no need to show these graphs on your write-up.) Based on these plots, guess the order of the AR(p), and the approximate values of the autoregressive parameters.  

(ii.) Subset the first 100 observations and repeat the analysis. Did any of your con- clusions change or become more or less certain?  

(iii.) Conduct your analysis on all 1000 observations. Did any of your conclusions change? If so, what implications does this have for assessing stationarity in time series in your field?  

#### (s)  
The first 20 periods show an AR(1) of $\phi_1 \approx 0.9$. This seems stationary.
The first 100 periods show an AR(1) of $\phi_1 \geq 1.0$. This now seems non-stationary.  
After seeing all 1000 periods, I think this is an AR(1) of $\phi_1 > 1.0$, i.e. non-stationary, explosive.  

#### (t)  
The first 20 periods show an AR(1) of $\phi_1 \approx 0.4$, so this seems stationary.  
The first 100 periods show an AR(1) of $\phi_1 \approx 0.7$, so still seems stationary.  
After seeing all 1000 periods, this TS seems to have an AR(1) of $\phi_1 \approx 0.8$, still stationary.  

#### (u)  
The first 20 periods show an AR(1) of $\phi_1 \approx 0.9$, so pretty high but still stationary.  
The first 100 periods show an AR(1) of $\phi_1 \approx 0.9$, so same as the first 20 periods.  
The whole TS show an AR(1) of $\phi_1 \approx 0.95$, it takes a long time to flush out this effect, but it's still stationary.  

#### (v)  
The first 20 periods show an AR(1) of $\phi_1 \approx 0.85$, high but stationary.  
The first 100 periods show an AR(1) of $\phi_1 \approx 0.95$, higher than the first 20 periods led on.  
The whole TS show an AR(1) of $\phi_1 \approx 0.99$, so this is almost non-stationary.  



















